// Generated by CoffeeScript 1.9.2
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  Game.Main = (function() {
    function Main(element_id) {
      this.create = bind(this.create, this);
      this.dataLoaded = bind(this.dataLoaded, this);
      this.assetsLoaded = bind(this.assetsLoaded, this);
      this.init = bind(this.init, this);
      this.assets = new Game.Assets();
      this.apiCaller = new Game.ApiCaller();
      this.stage = new Game.Stage(element_id);
    }

    Main.prototype.init = function() {
      this.assets.load(this.assetsLoaded);
      return this.stage.map.init(this.dataLoaded);
    };

    Main.prototype.assetsLoaded = function() {
      if (this.dataLoaded === true) {
        this.create();
      } else {
        this.assetsLoaded = true;
        console.log("assets loaded first");
      }
      return requestAnimationFrame(this.stage.update);
    };

    Main.prototype.dataLoaded = function(initData) {
      this.initData = initData;
      if (this.assetsLoaded === true) {
        return this.create();
      } else {
        this.dataLoaded = true;
        return console.log("data loaded first");
      }
    };

    Main.prototype.create = function() {
      this.headquarter = new Game.Headquarter(this.initData);
      return this.stage.create();
    };

    return Main;

  })();

}).call(this);
